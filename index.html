<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de F√≠sica com Gr√°fico</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.11.0/math.min.js"></script>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìê</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0f172a;
            color: white;
            min-height: 100vh;
            padding: 1rem;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        .card {
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 8px;
            padding: 1rem;
        }
        
        .card-header {
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 0.75rem;
            color: #22d3ee;
        }
        
        textarea {
            width: 100%;
            min-height: 350px;
            background: #0f172a;
            color: #e2e8f0;
            border: 1px solid #475569;
            border-radius: 4px;
            padding: 1rem;
            font-family: 'Courier New', monospace;
            font-size: 1rem;
            resize: vertical;
            outline: none;
        }
        
        button {
            width: 100%;
            padding: 0.9rem;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1rem;
            margin-top: 0.5rem;
        }
        
        .btn-calculate {
            background: #10b981;
            color: white;
        }
        
        .btn-calculate:hover {
            background: #059669;
        }
        
        canvas {
            width: 100%;
            background: #0f172a;
            border-radius: 4px;
            border: 1px solid #475569;
        }
        
        .results {
            background: #0f172a;
            border: 2px solid #22d3ee;
            border-radius: 6px;
            padding: 1rem;
            margin-top: 1rem;
        }
        
        .result-title {
            color: #22d3ee;
            font-weight: bold;
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
        }
        
        .result-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }
        
        .result-item {
            background: #1e293b;
            padding: 0.75rem;
            border-radius: 4px;
            border: 1px solid #334155;
        }
        
        .result-label {
            color: #94a3b8;
            font-size: 0.85rem;
            margin-bottom: 0.25rem;
        }
        
        .result-value {
            color: #22d3ee;
            font-weight: bold;
            font-size: 1.3rem;
            font-family: monospace;
        }
        
        .error {
            background: #7f1d1d;
            border: 1px solid #991b1b;
            color: #fca5a5;
            padding: 0.75rem;
            border-radius: 4px;
            margin-top: 0.5rem;
        }
        
        .help {
            background: #1e293b;
            padding: 0.75rem;
            border-radius: 4px;
            font-size: 0.9rem;
            color: #cbd5e1;
            margin-bottom: 1rem;
            line-height: 1.6;
        }
        
        .help-title {
            color: #22d3ee;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        
        code {
            background: #0f172a;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            color: #fbbf24;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Painel Esquerdo -->
        <div>
            <div class="card">
                <div class="card-header">üìù Suas F√≥rmulas (igual no papel)</div>
                
                <div class="help">
                    <div class="help-title">Como usar:</div>
                    1. Defina todos os valores: <code>t = 3</code>, <code>v = 7</code><br>
                    2. Escreva as f√≥rmulas: <code>x = v*t</code><br>
                    3. Clique em <strong>Calcular</strong><br>
                    4. Veja o resultado no <strong>GR√ÅFICO</strong>! ‚úÖ
                </div>
                
                <textarea id="formulaInput" spellcheck="false"># Exemplo simples
# Calcular posi√ß√£o com velocidade constante

t = 3       # tempo em segundos
v = 7       # velocidade em m/s

x = v*t     # posi√ß√£o em x
y = 0       # posi√ß√£o em y

# Resultado: x = 21 metros</textarea>
                
                <button class="btn-calculate" onclick="calculate()">üßÆ Calcular e Mostrar no Gr√°fico</button>
                
                <div id="errorDisplay"></div>
            </div>
        </div>
        
        <!-- Painel Direito -->
        <div>
            <div class="card">
                <div class="card-header">üìä Gr√°fico - Valida√ß√£o Visual</div>
                <canvas id="canvas" width="700" height="500"></canvas>
            </div>
            
            <div class="results" id="resultsDisplay" style="display:none">
                <div class="result-title">‚úÖ Resultados Calculados</div>
                <div class="result-grid" id="resultGrid"></div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        
        // Inicializa gr√°fico vazio
        drawEmptyGraph();
        
        function calculate() {
            const input = document.getElementById('formulaInput').value;
            const errorDisplay = document.getElementById('errorDisplay');
            const resultsDisplay = document.getElementById('resultsDisplay');
            const resultGrid = document.getElementById('resultGrid');
            
            errorDisplay.innerHTML = '';
            
            try {
                const lines = input.split('\n');
                const scope = {};
                const results = {};
                
                // Processa linha por linha
                for (let line of lines) {
                    line = line.trim();
                    
                    // Ignora coment√°rios e linhas vazias
                    if (line.startsWith('#') || line === '') continue;
                    
                    // Processa atribui√ß√µes
                    if (line.includes('=')) {
                        const [left, right] = line.split('=').map(s => s.trim());
                        
                        try {
                            const value = math.evaluate(right, scope);
                            scope[left] = value;
                            results[left] = value;
                        } catch (e) {
                            throw new Error(`Erro na linha "${line}": ${e.message}`);
                        }
                    }
                }
                
                if (Object.keys(results).length === 0) {
                    throw new Error('Nenhuma equa√ß√£o encontrada! Use: variavel = valor');
                }
                
                // Pega valores principais
                const x = results.x || 0;
                const y = results.y || 0;
                const t = results.t || 0;
                
                // Desenha no gr√°fico
                drawGraph(x, y, results);
                
                // Mostra resultados
                resultsDisplay.style.display = 'block';
                resultGrid.innerHTML = '';
                
                // Mostra principais primeiro
                const mainVars = ['t', 'x', 'y', 'v', 'vx', 'vy', 'a', 'ax', 'ay'];
                const shown = new Set();
                
                mainVars.forEach(variable => {
                    if (results[variable] !== undefined) {
                        const value = results[variable];
                        const formattedValue = typeof value === 'number' ? value.toFixed(3) : value;
                        resultGrid.innerHTML += `
                            <div class="result-item">
                                <div class="result-label">${variable}</div>
                                <div class="result-value">${formattedValue}</div>
                            </div>
                        `;
                        shown.add(variable);
                    }
                });
                
                // Mostra outros
                Object.entries(results).forEach(([variable, value]) => {
                    if (!shown.has(variable)) {
                        const formattedValue = typeof value === 'number' ? value.toFixed(3) : value;
                        resultGrid.innerHTML += `
                            <div class="result-item">
                                <div class="result-label">${variable}</div>
                                <div class="result-value">${formattedValue}</div>
                            </div>
                        `;
                    }
                });
                
            } catch (e) {
                errorDisplay.innerHTML = `<div class="error">‚ö†Ô∏è ${e.message}</div>`;
                drawEmptyGraph();
            }
        }
        
        function drawEmptyGraph() {
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.fillStyle = '#0f172a';
            ctx.fillRect(0, 0, width, height);
            
            const scale = 10;
            const originX = width / 2;
            const originY = height / 2;
            
            // Grid
            ctx.strokeStyle = '#1e293b';
            ctx.lineWidth = 1;
            
            for (let x = 0; x <= width; x += scale * 5) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, height);
                ctx.stroke();
            }
            
            for (let y = 0; y <= height; y += scale * 5) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(width, y);
                ctx.stroke();
            }
            
            // Eixos
            ctx.strokeStyle = '#475569';
            ctx.lineWidth = 2;
            
            // Eixo X
            ctx.beginPath();
            ctx.moveTo(0, originY);
            ctx.lineTo(width, originY);
            ctx.stroke();
            
            // Eixo Y
            ctx.beginPath();
            ctx.moveTo(originX, 0);
            ctx.lineTo(originX, height);
            ctx.stroke();
            
            // Labels dos eixos
            ctx.fillStyle = '#64748b';
            ctx.font = 'bold 14px sans-serif';
            ctx.fillText('X (metros)', width - 80, originY - 10);
            ctx.fillText('Y (metros)', originX + 10, 20);
            
            // Origem
            ctx.fillStyle = '#94a3b8';
            ctx.font = '12px monospace';
            ctx.fillText('0', originX + 5, originY - 5);
            
            // Marca√ß√µes
            ctx.fillStyle = '#64748b';
            ctx.font = '11px monospace';
            
            for (let i = -30; i <= 30; i += 10) {
                if (i === 0) continue;
                
                const xPos = originX + i * scale;
                const yPos = originY - i * scale;
                
                if (xPos > 0 && xPos < width) {
                    ctx.fillText(i.toString(), xPos - 8, originY + 15);
                }
                
                if (yPos > 0 && yPos < height) {
                    ctx.fillText(i.toString(), originX - 25, yPos + 4);
                }
            }
            
            // Instru√ß√£o
            ctx.fillStyle = '#64748b';
            ctx.font = '16px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Preencha as f√≥rmulas e clique em Calcular', width/2, height - 20);
            ctx.textAlign = 'left';
        }
        
        function drawGraph(posX, posY, results) {
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.fillStyle = '#0f172a';
            ctx.fillRect(0, 0, width, height);
            
            // Calcula escala autom√°tica baseada nos valores
            let maxVal = Math.max(Math.abs(posX), Math.abs(posY), 10);
            let scale = Math.min(width, height) / (maxVal * 2.5);
            
            const originX = width / 2;
            const originY = height / 2;
            
            // Grid
            ctx.strokeStyle = '#1e293b';
            ctx.lineWidth = 1;
            
            const gridSpacing = scale * 5;
            for (let x = 0; x <= width; x += gridSpacing) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, height);
                ctx.stroke();
            }
            
            for (let y = 0; y <= height; y += gridSpacing) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(width, y);
                ctx.stroke();
            }
            
            // Eixos
            ctx.strokeStyle = '#475569';
            ctx.lineWidth = 3;
            
            ctx.beginPath();
            ctx.moveTo(0, originY);
            ctx.lineTo(width, originY);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(originX, 0);
            ctx.lineTo(originX, height);
            ctx.stroke();
            
            // Labels
            ctx.fillStyle = '#94a3b8';
            ctx.font = 'bold 14px sans-serif';
            ctx.fillText('X (metros)', width - 90, originY - 10);
            ctx.fillText('Y (metros)', originX + 10, 25);
            
            // Origem
            ctx.fillStyle = '#cbd5e1';
            ctx.font = 'bold 13px monospace';
            ctx.fillText('(0,0)', originX + 8, originY - 8);
            
            // Marca√ß√µes nos eixos
            ctx.fillStyle = '#94a3b8';
            ctx.font = '12px monospace';
            
            const step = 5;
            const range = Math.ceil(maxVal / step) * step;
            
            for (let i = -range; i <= range; i += step) {
                if (i === 0) continue;
                
                const xPos = originX + i * scale;
                const yPos = originY - i * scale;
                
                if (xPos > 30 && xPos < width - 30) {
                    ctx.fillText(i.toString(), xPos - 8, originY + 18);
                    
                    // Linha de marca√ß√£o
                    ctx.strokeStyle = '#334155';
                    ctx.lineWidth = 1;
                    ctx.beginPath();
                    ctx.moveTo(xPos, originY - 5);
                    ctx.lineTo(xPos, originY + 5);
                    ctx.stroke();
                }
                
                if (yPos > 30 && yPos < height - 30) {
                    ctx.fillText(i.toString(), originX - 30, yPos + 5);
                    
                    // Linha de marca√ß√£o
                    ctx.strokeStyle = '#334155';
                    ctx.lineWidth = 1;
                    ctx.beginPath();
                    ctx.moveTo(originX - 5, yPos);
                    ctx.lineTo(originX + 5, yPos);
                    ctx.stroke();
                }
            }
            
            // Calcula posi√ß√£o no canvas
            const objX = originX + posX * scale;
            const objY = originY - posY * scale;
            
            // Linha da origem at√© o objeto
            ctx.strokeStyle = '#60a5fa';
            ctx.lineWidth = 2;
            ctx.setLineDash([5, 5]);
            ctx.beginPath();
            ctx.moveTo(originX, originY);
            ctx.lineTo(objX, objY);
            ctx.stroke();
            ctx.setLineDash([]);
            
            // Linhas de grade at√© o objeto
            ctx.strokeStyle = '#334155';
            ctx.lineWidth = 1;
            ctx.setLineDash([3, 3]);
            
            // Vertical
            ctx.beginPath();
            ctx.moveTo(objX, originY);
            ctx.lineTo(objX, objY);
            ctx.stroke();
            
            // Horizontal
            ctx.beginPath();
            ctx.moveTo(originX, objY);
            ctx.lineTo(objX, objY);
            ctx.stroke();
            
            ctx.setLineDash([]);
            
            // Objeto principal
            ctx.fillStyle = '#10b981';
            ctx.strokeStyle = '#22d3ee';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.arc(objX, objY, 12, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            
            // Label da posi√ß√£o
            ctx.fillStyle = '#22d3ee';
            ctx.font = 'bold 14px monospace';
            const label = `(${posX.toFixed(1)}, ${posY.toFixed(1)})`;
            ctx.fillText(label, objX + 18, objY - 12);
            
            // Desenha vetores se existirem
            if (results.vx !== undefined || results.vy !== undefined) {
                const vx = results.vx || 0;
                const vy = results.vy || 0;
                const velScale = 5;
                
                ctx.strokeStyle = '#3b82f6';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(objX, objY);
                ctx.lineTo(objX + vx * velScale, objY - vy * velScale);
                ctx.stroke();
                
                // Seta
                const angle = Math.atan2(-vy, vx);
                const arrowLen = 10;
                ctx.beginPath();
                ctx.moveTo(objX + vx * velScale, objY - vy * velScale);
                ctx.lineTo(
                    objX + vx * velScale - arrowLen * Math.cos(angle - Math.PI/6),
                    objY - vy * velScale + arrowLen * Math.sin(angle - Math.PI/6)
                );
                ctx.moveTo(objX + vx * velScale, objY - vy * velScale);
                ctx.lineTo(
                    objX + vx * velScale - arrowLen * Math.cos(angle + Math.PI/6),
                    objY - vy * velScale + arrowLen * Math.sin(angle + Math.PI/6)
                );
                ctx.stroke();
                
                // Label velocidade
                ctx.fillStyle = '#3b82f6';
                ctx.font = '12px sans-serif';
                ctx.fillText('v', objX + vx * velScale + 15, objY - vy * velScale);
            }
        }
    </script>
</body>
</html>
