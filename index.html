<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora de F√≠sica com Trajet√≥ria</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.11.0/math.min.js"></script>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üìê</text></svg>">
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #0f172a;
            color: white;
            min-height: 100vh;
            padding: 1rem;
        }
        
        .container {
            max-width: 1600px;
            margin: 0 auto;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 1rem;
        }
        
        .card {
            background: #1e293b;
            border: 1px solid #334155;
            border-radius: 8px;
            padding: 1rem;
        }
        
        .card-header {
            font-size: 1.1rem;
            font-weight: bold;
            margin-bottom: 0.75rem;
            color: #22d3ee;
        }
        
        textarea {
            width: 100%;
            min-height: 350px;
            background: #0f172a;
            color: #e2e8f0;
            border: 1px solid #475569;
            border-radius: 4px;
            padding: 1rem;
            font-family: 'Courier New', monospace;
            font-size: 1rem;
            resize: vertical;
            outline: none;
        }
        
        button {
            width: 100%;
            padding: 0.9rem;
            border: none;
            border-radius: 6px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
            font-size: 1rem;
            margin-top: 0.5rem;
        }
        
        .btn-calculate {
            background: #10b981;
            color: white;
        }
        
        .btn-calculate:hover {
            background: #059669;
        }
        
        canvas {
            width: 100%;
            background: #0f172a;
            border-radius: 4px;
            border: 1px solid #475569;
        }
        
        .results {
            background: #0f172a;
            border: 2px solid #22d3ee;
            border-radius: 6px;
            padding: 1rem;
            margin-top: 1rem;
        }
        
        .result-title {
            color: #22d3ee;
            font-weight: bold;
            margin-bottom: 0.75rem;
            font-size: 1.1rem;
        }
        
        .result-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 0.75rem;
        }
        
        .result-item {
            background: #1e293b;
            padding: 0.75rem;
            border-radius: 4px;
            border: 1px solid #334155;
        }
        
        .result-label {
            color: #94a3b8;
            font-size: 0.85rem;
            margin-bottom: 0.25rem;
        }
        
        .result-value {
            color: #22d3ee;
            font-weight: bold;
            font-size: 1.3rem;
            font-family: monospace;
        }
        
        .error {
            background: #7f1d1d;
            border: 1px solid #991b1b;
            color: #fca5a5;
            padding: 0.75rem;
            border-radius: 4px;
            margin-top: 0.5rem;
        }
        
        .help {
            background: #1e293b;
            padding: 0.75rem;
            border-radius: 4px;
            font-size: 0.9rem;
            color: #cbd5e1;
            margin-bottom: 1rem;
            line-height: 1.6;
        }
        
        .help-title {
            color: #22d3ee;
            font-weight: bold;
            margin-bottom: 0.5rem;
        }
        
        code {
            background: #0f172a;
            padding: 0.2rem 0.4rem;
            border-radius: 3px;
            color: #fbbf24;
            font-family: monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Painel Esquerdo -->
        <div>
            <div class="card">
                <div class="card-header">üìù Suas F√≥rmulas (igual no papel)</div>
                
                <div class="help">
                    <div class="help-title">Como usar:</div>
                    1. Defina <strong>todos</strong> os valores: <code>t = 5</code>, <code>v = 10</code><br>
                    2. Escreva as f√≥rmulas: <code>x = v*t</code><br>
                    3. Clique em <strong>Calcular</strong><br>
                    4. Veja a <strong>TRAJET√ìRIA</strong> de t=0 at√© o t que voc√™ definiu! üéØ
                </div>
                
                <textarea id="formulaInput" spellcheck="false"># Exemplo: Velocidade constante
# Ver trajet√≥ria de t=0 at√© t=5

t = 5       # tempo final (segundos)
v = 10      # velocidade (m/s)

x = v*t     # posi√ß√£o em x
y = 0       # posi√ß√£o em y

# Mostra caminho de x=0 at√© x=50</textarea>
                
                <button class="btn-calculate" onclick="calculate()">üßÆ Calcular e Mostrar Trajet√≥ria</button>
                
                <div id="errorDisplay"></div>
            </div>
        </div>
        
        <!-- Painel Direito -->
        <div>
            <div class="card">
                <div class="card-header">üìä Gr√°fico - Trajet√≥ria Completa</div>
                <canvas id="canvas" width="700" height="500"></canvas>
            </div>
            
            <div class="results" id="resultsDisplay" style="display:none">
                <div class="result-title">‚úÖ Resultados em t = <span id="timeValue"></span>s</div>
                <div class="result-grid" id="resultGrid"></div>
            </div>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        
        // Inicializa gr√°fico vazio
        drawEmptyGraph();
        
        function calculate() {
            const input = document.getElementById('formulaInput').value;
            const errorDisplay = document.getElementById('errorDisplay');
            const resultsDisplay = document.getElementById('resultsDisplay');
            const resultGrid = document.getElementById('resultGrid');
            
            errorDisplay.innerHTML = '';
            
            try {
                // Primeiro, extrai as constantes e f√≥rmulas SEM substituir t
                const lines = input.split('\n');
                const constants = {};
                const formulas = {};
                let tValue = null;
                
                for (let line of lines) {
                    line = line.trim();
                    if (line.startsWith('#') || line === '') continue;
                    
                    if (line.includes('=')) {
                        const [left, right] = line.split('=').map(s => s.trim());
                        
                        // Se √© t, guarda o valor
                        if (left === 't') {
                            tValue = math.evaluate(right);
                            continue;
                        }
                        
                        // Se n√£o cont√©m t, √© constante
                        if (!right.includes('t')) {
                            constants[left] = math.evaluate(right, constants);
                        } else {
                            // √â f√≥rmula que depende de t
                            formulas[left] = right;
                        }
                    }
                }
                
                if (tValue === null) {
                    throw new Error('Defina o tempo: t = valor');
                }
                
                if (Object.keys(formulas).length === 0) {
                    throw new Error('Defina pelo menos uma f√≥rmula com t (ex: x = v*t)');
                }
                
                // Calcula trajet√≥ria de t=0 at√© tValue
                const trajectory = [];
                const steps = 100;
                const dt = tValue / steps;
                
                for (let i = 0; i <= steps; i++) {
                    const currentT = i * dt;
                    const scope = { ...constants, t: currentT };
                    const point = {};
                    
                    for (let [variable, formula] of Object.entries(formulas)) {
                        point[variable] = math.evaluate(formula, scope);
                    }
                    
                    trajectory.push({
                        t: currentT,
                        x: point.x || 0,
                        y: point.y || 0,
                        ...point
                    });
                }
                
                // Pega valores finais (em t = tValue)
                const finalValues = trajectory[trajectory.length - 1];
                
                // Desenha trajet√≥ria
                drawTrajectory(trajectory, finalValues, tValue);
                
                // Mostra resultados
                resultsDisplay.style.display = 'block';
                document.getElementById('timeValue').textContent = tValue.toFixed(2);
                resultGrid.innerHTML = '';
                
                // Mostra principais
                const mainVars = ['x', 'y', 'v', 'vx', 'vy', 'a', 'ax', 'ay'];
                const shown = new Set(['t']);
                
                mainVars.forEach(variable => {
                    if (finalValues[variable] !== undefined) {
                        const value = finalValues[variable];
                        const formattedValue = typeof value === 'number' ? value.toFixed(3) : value;
                        resultGrid.innerHTML += `
                            <div class="result-item">
                                <div class="result-label">${variable}</div>
                                <div class="result-value">${formattedValue}</div>
                            </div>
                        `;
                        shown.add(variable);
                    }
                });
                
                // Mostra outros
                Object.entries(finalValues).forEach(([variable, value]) => {
                    if (!shown.has(variable)) {
                        const formattedValue = typeof value === 'number' ? value.toFixed(3) : value;
                        resultGrid.innerHTML += `
                            <div class="result-item">
                                <div class="result-label">${variable}</div>
                                <div class="result-value">${formattedValue}</div>
                            </div>
                        `;
                    }
                });
                
            } catch (e) {
                errorDisplay.innerHTML = `<div class="error">‚ö†Ô∏è ${e.message}</div>`;
                drawEmptyGraph();
            }
        }
        
        function drawEmptyGraph() {
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.fillStyle = '#0f172a';
            ctx.fillRect(0, 0, width, height);
            
            const scale = 10;
            const originX = width / 2;
            const originY = height / 2;
            
            // Grid
            ctx.strokeStyle = '#1e293b';
            ctx.lineWidth = 1;
            
            for (let x = 0; x <= width; x += scale * 5) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, height);
                ctx.stroke();
            }
            
            for (let y = 0; y <= height; y += scale * 5) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(width, y);
                ctx.stroke();
            }
            
            // Eixos
            ctx.strokeStyle = '#475569';
            ctx.lineWidth = 2;
            
            ctx.beginPath();
            ctx.moveTo(0, originY);
            ctx.lineTo(width, originY);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(originX, 0);
            ctx.lineTo(originX, height);
            ctx.stroke();
            
            // Labels
            ctx.fillStyle = '#64748b';
            ctx.font = 'bold 14px sans-serif';
            ctx.fillText('X (metros)', width - 80, originY - 10);
            ctx.fillText('Y (metros)', originX + 10, 20);
            
            // Instru√ß√£o
            ctx.fillStyle = '#64748b';
            ctx.font = '16px sans-serif';
            ctx.textAlign = 'center';
            ctx.fillText('Defina as f√≥rmulas e clique em Calcular', width/2, height - 20);
            ctx.textAlign = 'left';
        }
        
        function drawTrajectory(trajectory, finalValues, tValue) {
            const width = canvas.width;
            const height = canvas.height;
            
            ctx.fillStyle = '#0f172a';
            ctx.fillRect(0, 0, width, height);
            
            // Encontra limites
            let minX = 0, maxX = 0, minY = 0, maxY = 0;
            trajectory.forEach(point => {
                minX = Math.min(minX, point.x);
                maxX = Math.max(maxX, point.x);
                minY = Math.min(minY, point.y);
                maxY = Math.max(maxY, point.y);
            });
            
            // Calcula escala
            const rangeX = Math.max(Math.abs(minX), Math.abs(maxX), 10);
            const rangeY = Math.max(Math.abs(minY), Math.abs(maxY), 10);
            const maxRange = Math.max(rangeX, rangeY);
            
            const scale = Math.min(width, height) / (maxRange * 2.5);
            const originX = width / 2;
            const originY = height / 2;
            
            // Grid
            ctx.strokeStyle = '#1e293b';
            ctx.lineWidth = 1;
            
            const gridSpacing = scale * 5;
            for (let x = 0; x <= width; x += gridSpacing) {
                ctx.beginPath();
                ctx.moveTo(x, 0);
                ctx.lineTo(x, height);
                ctx.stroke();
            }
            
            for (let y = 0; y <= height; y += gridSpacing) {
                ctx.beginPath();
                ctx.moveTo(0, y);
                ctx.lineTo(width, y);
                ctx.stroke();
            }
            
            // Eixos
            ctx.strokeStyle = '#475569';
            ctx.lineWidth = 3;
            
            ctx.beginPath();
            ctx.moveTo(0, originY);
            ctx.lineTo(width, originY);
            ctx.stroke();
            
            ctx.beginPath();
            ctx.moveTo(originX, 0);
            ctx.lineTo(originX, height);
            ctx.stroke();
            
            // Labels
            ctx.fillStyle = '#94a3b8';
            ctx.font = 'bold 14px sans-serif';
            ctx.fillText('X (m)', width - 60, originY - 10);
            ctx.fillText('Y (m)', originX + 10, 25);
            
            // Origem
            ctx.fillStyle = '#cbd5e1';
            ctx.font = 'bold 12px monospace';
            ctx.fillText('(0,0)', originX + 8, originY - 8);
            
            // Marca√ß√µes
            ctx.fillStyle = '#94a3b8';
            ctx.font = '11px monospace';
            
            const step = Math.ceil(maxRange / 10) * 2;
            for (let i = -maxRange; i <= maxRange; i += step) {
                if (i === 0 || Math.abs(i) < 0.1) continue;
                
                const xPos = originX + i * scale;
                const yPos = originY - i * scale;
                
                if (xPos > 30 && xPos < width - 30) {
                    ctx.fillText(Math.round(i).toString(), xPos - 10, originY + 18);
                }
                
                if (yPos > 30 && yPos < height - 30) {
                    ctx.fillText(Math.round(i).toString(), originX - 30, yPos + 5);
                }
            }
            
            // Desenha TRAJET√ìRIA COMPLETA
            ctx.strokeStyle = '#60a5fa';
            ctx.lineWidth = 3;
            ctx.beginPath();
            
            trajectory.forEach((point, i) => {
                const x = originX + point.x * scale;
                const y = originY - point.y * scale;
                
                if (i === 0) {
                    ctx.moveTo(x, y);
                } else {
                    ctx.lineTo(x, y);
                }
            });
            
            ctx.stroke();
            
            // Ponto inicial (verde)
            const startX = originX + trajectory[0].x * scale;
            const startY = originY - trajectory[0].y * scale;
            
            ctx.fillStyle = '#10b981';
            ctx.strokeStyle = '#22d3ee';
            ctx.lineWidth = 2;
            ctx.beginPath();
            ctx.arc(startX, startY, 8, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            
            ctx.fillStyle = '#10b981';
            ctx.font = 'bold 12px sans-serif';
            ctx.fillText('t=0', startX + 12, startY - 8);
            
            // Ponto final (amarelo maior)
            const endX = originX + finalValues.x * scale;
            const endY = originY - finalValues.y * scale;
            
            ctx.fillStyle = '#f59e0b';
            ctx.strokeStyle = '#fbbf24';
            ctx.lineWidth = 3;
            ctx.beginPath();
            ctx.arc(endX, endY, 12, 0, Math.PI * 2);
            ctx.fill();
            ctx.stroke();
            
            // Label do ponto final
            ctx.fillStyle = '#fbbf24';
            ctx.font = 'bold 13px monospace';
            const label = `(${finalValues.x.toFixed(1)}, ${finalValues.y.toFixed(1)})`;
            ctx.fillText(label, endX + 18, endY - 12);
            
            ctx.font = 'bold 12px sans-serif';
            ctx.fillText(`t=${tValue}s`, endX + 18, endY + 8);
            
            // Desenha vetores se existirem
            if (finalValues.vx !== undefined || finalValues.vy !== undefined) {
                const vx = finalValues.vx || 0;
                const vy = finalValues.vy || 0;
                const velScale = 5;
                
                ctx.strokeStyle = '#3b82f6';
                ctx.lineWidth = 3;
                ctx.beginPath();
                ctx.moveTo(endX, endY);
                ctx.lineTo(endX + vx * velScale, endY - vy * velScale);
                ctx.stroke();
                
                // Seta
                const angle = Math.atan2(-vy, vx);
                const arrowLen = 10;
                ctx.beginPath();
                ctx.moveTo(endX + vx * velScale, endY - vy * velScale);
                ctx.lineTo(
                    endX + vx * velScale - arrowLen * Math.cos(angle - Math.PI/6),
                    endY - vy * velScale + arrowLen * Math.sin(angle - Math.PI/6)
                );
                ctx.moveTo(endX + vx * velScale, endY - vy * velScale);
                ctx.lineTo(
                    endX + vx * velScale - arrowLen * Math.cos(angle + Math.PI/6),
                    endY - vy * velScale + arrowLen * Math.sin(angle + Math.PI/6)
                );
                ctx.stroke();
            }
        }
    </script>
</body>
</html>
